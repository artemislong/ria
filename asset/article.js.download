var $jscomp={scope:{},findInternal:function(a,b,d){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(b.call(d,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6-impl","es3");
$(function(){startArticleJS($(".endless__item"),"first");window.endlessScroll={init:function(){var a=this;a.firstId=window.endlessScrollFirst;a.uploadUrl=window.endlessScrollUrl;a.autofillAlgorithm=window.endlessScrollAlgorithm;a.uploadQueue=window.endlessScrollQueue;a.$endless=$("#endless");if(1==$("body").data("endless-off"))return console.log("EndlessScroll id disabled in settings"),!1;if(!a.uploadUrl||0< !a.uploadQueue.length||0< !a.$endless.length)return console.log("Can't start endlessScroll: UploadUrl = "+
a.uploadUrl+" QueueLength = "+a.uploadQueue.length+" EndlessLength = "+a.$endless.length),!1;window.EVENTSTACK||(window.EVENTSTACK=[]);a["class"]={endlessItem:".endless__item",endlessItemContent:".endless__item-content",endlessItemHide:".endless__item-hide",articleAhchor:".article__anchor",modFollow:"m-follow",modActive:"m-active",modFollowFixed:"m-follow-fixed"};a.metaAnalyticsRemove=["title_ver","title_alg","rcmd_alg","rcmd_id"];a.uploadActive=0;a.uploadCount=a.uploadQueue.length;a.upload=!1;a.uploadErrorCount=
0;a.$items=!1;a.$activeItem=!1;a.$followItems=!1;a.$followItemsContent=!1;a.updateSets();a.urlParams=a.$endless.data("scroll-params")&&""!=a.$endless.data("scroll-params")?a.$endless.data("scroll-params"):"";a.switchTop=0;a.updateSwitchTop();a.clientHeight=this.getClientHeigth();a.supportObserver=window.IntersectionObserver?!0:!1;a.supportObserver?(a.endlessObserver=new IntersectionObserver(function(){a.onScroll()},{rootMargin:"-46px 0px 0px 0px"}),$.each($(a["class"].endlessItem,a.$endless),function(b,
d){a.endlessObserver.observe(d)})):$(window).scroll(function(){a.onScroll()});$(window).resize(function(){a.onResize()});$(window).resize();$(window).bind("scroll.article_first_upload",function(){50<$(window).scrollTop()&&(a.checkUploadItem(),$(window).unbind("scroll.article_first_upload"))});a.articleScrollEvents(this.$activeItem);a.eventstack()},eventstack:function(){var a=$('meta[name = "analytics:title_ver"]').attr("content"),b=$('meta[name = "analytics:title_alg"]').attr("content"),d=$('meta[name = "analytics:rcmd_alg"]').attr("content"),
c=$('meta[name = "analytics:rcmd_id"]').attr("content");a&&b&&window.EVENTSTACK.push(["click","main_title_ver",{article_id:this.firstId,hash:a,algorithm:b}]);d&&(c?window.EVENTSTACK.push(["click","article_rcmd_under_article",{article_id:this.firstId,source_aid:c,algorithm:d}]):window.EVENTSTACK.push(["click","main_rcmd_floor",{article_id:this.firstId,algorithm:d}]))},onScroll:function(){this.checkChangeItem();this.updateSwitchTop()},onResize:function(){this.clientHeight=this.getClientHeigth();this.updateSwitchTop()},
checkChangeItem:function(){var a=this.$activeItem.offset().top-$(window).scrollTop();if(a+this.$activeItem.outerHeight()<=this.switchTop&&this.$followItems.length){$(this.$followItems[0]).removeClass(this["class"].modFollow);this.changeItemEvents(!0);this.$items.length>this.uploadActive&&this.checkUploadItem();var b=this.$activeItem.data("event-url")&&""!=this.$activeItem.data("event-url")?this.$activeItem.data("event-url"):!1;!1!==b&&this.$activeItem.removeAttr("data-event-url").data("event-url",
"").find(".article").append('<img class="article__event-img" data-event="adFoxEvent" src="'+b+'" alt=""/>')}a>this.switchTop&&1<this.$items.length&&(this.$activeItem.addClass(this["class"].modFollow),this.changeItemEvents(),this.updateArticleData(this.$activeItem))},changeItemEvents:function(a){this.updateSets();this.changeProject(this.$activeItem.data("project"));this.changeHeader(this.$activeItem);history.replaceState(null,this.$activeItem.data("title"),location.origin+this.$activeItem.data("url")+
(this.urlParams&&""!=this.urlParams?"?"+this.urlParams:""));this.updateArticleData(this.$activeItem,a)},changeProject:function(a){var b=$("body");"ria"==a?(b.removeClass("m-rsport m-realty m-radiosputnik"),b.addClass("m-ria")):"rsport"==a?(b.removeClass("m-ria m-realty m-radiosputnik"),b.addClass("m-rsport")):"realty"==a?(b.removeClass("m-rsport m-ria m-radiosputnik"),b.addClass("m-realty")):"radiosputnik"==a&&(b.removeClass("m-rsport m-ria m-realty"),b.addClass("m-radiosputnik"))},changeHeader:function(a){$("body").removeClass("m-header-short m-header-share");
a.data("header-type")&&($("body").addClass("m-header-"+a.data("header-type")),$(".share.m-header").attr({"data-url":a.data("full-url"),"data-title":a.data("title"),"data-id":a.data("id")}))},updateArticleData:function(a,b){document.title=a.data("head-title");$('meta[name="keywords"]').attr("content",a.data("keywords"));$('meta[property="article:published_time"]').attr("content",a.data("published"));$('meta[property="article:author"]').attr("content",a.data("author"));$('meta[name="analytics:title"]').attr("content",
a.data("title"));$('meta[name="analytics:keyw"]').attr("content",a.data("analytics-keyw"));$('meta[name="analytics:rubric"]').attr("content",a.data("analytics-rubric"));$('meta[name="analytics:tags"]').attr("content",a.data("analytics-tags"));$('meta[name="analytics:site_domain"]').attr("content",a.data("domain"));$('meta[name="analytics:article_id"]').attr("content",a.data("id"));$('meta[name="analytics:url"]').attr("content",a.data("full-url"));$('meta[name="analytics:p_ts"]').attr("content",a.data("pts"));
$('meta[name="analytics:author"]').attr("content",""!=a.data("author").trim()?a.data("author"):a.data("author-korr"));$('meta[name="analytics:isscroll"]').attr("content",a.data("is-scroll"));$.each(this.metaAnalyticsRemove,function(a,c){$('meta[name="analytics:'+c+'"]').remove()});GLOBAL&&GLOBAL.article&&(GLOBAL.article.id=a.data("id"),GLOBAL.article.show=!!a.data("article-show"));window.dataLayer=window.dataLayer||[];dataLayer.push({event:"infinite_pageview",page_title:a.data("title"),page_path:a.data("url"),
page_domain:a.data("domain"),page_url:a.data("full-url"),page_tags:a.data("analytics-tags"),page_rubric:a.data("analytics-rubric"),page_number:a.data("endless"),article_id:a.data("id"),article_length:a.data("text-length")});b&&!a.data("event-once")&&(piwik_log(a.data("head-title"),"ria","https://a.ria.ru/counter"),window.EVENTSTACK.push(["scroll","article_infinity",{article_id:a.data("id"),source_aid:this.firstId,algorithm:this.autofillAlgorithm,textlength:a.data("text-length")}]),a.attr("data-event-once",
!0))},checkUploadItem:function(){this.uploadActive<this.uploadCount&&!this.upload&&(this.upload=!0,this.uploadItem())},uploadItem:function(){var a=this;if("banner"==a.uploadQueue[a.uploadActive]){var b=$(".endless__choose-position-"+(a.uploadActive+1)+" div[ data-endless-id ]").data("endless-id");"number"==typeof b&&0<b&&0>$.inArray(b,a.uploadQueue)&&b!=a.firstId?a.uploadQueue[a.uploadActive]=b:(a.uploadQueue.splice(a.uploadActive,1),a.uploadCount=a.uploadQueue.length,$('.endless__choose div[ data-endless-id="'+
b+'"]').remove());a.upload=!1;a.checkUploadItem()}else isNaN(Number(this.uploadQueue[this.uploadActive]))&&(this.uploadActive++,this.checkUploadItem()),$.ajax({url:a.uploadUrl+a.uploadQueue[a.uploadActive]+".html?endless="+(a.uploadActive+2)+(a.urlParams&&""!=a.urlParams?"&"+a.urlParams:""),dataType:"html",type:"GET",success:function(b){window.Ya&&window.Ya.headerBidding&&window.Ya.headerBidding.pushAdUnits&&"function"==typeof window.Ya.headerBidding.pushAdUnits&&(window.headerBiddingPushAdUnits=
function(a){window.Ya.headerBidding.pushAdUnits(a)});b=$(b);var c=$('.endless__choose div[ data-endless-id="'+a.uploadQueue[a.uploadActive]+'" ]').data("event-url");c&&b.attr("data-event-url",c);b.attr("data-endless",a.uploadActive+2);a.$endless.append(b);a.uploadActive++;a.updateSets();startArticleJS(b.filter(a["class"].endlessItem));a.upload=!1;a.uploadErrorCount=0;a.articleScrollEvents(b);a.supportObserver&&$.each(b,function(b,c){a.endlessObserver.observe(c)})},error:function(){5>a.uploadErrorCount&&
(a.uploadErrorCount++,setTimeout(function(){a.uploadItem()},2E3))}})},updateSwitchTop:function(){this.switchTop=$(body).hasClass("m-header-sticked")?$("#headerSticked").height():0},articleScrollEvents:function(a){this.articlePercentEvents(a);this.eventScrollArticleEnd(a)},articlePercentEvents:function(a){if(this.supportObserver){var b=new IntersectionObserver(function(a){$.each($(a),function(a,b){if(1==b.isIntersecting){var c=$(b.target);c.data("event-once")||(c.attr("data-event-once","true"),window.EVENTSTACK.push(["scroll",
"author_doscroll",{doscroll_percent:c.data("percent"),article_id:c.data("id")}]))}})});$.each($(this["class"].articleAhchor,a),function(a,c){b.observe(c)})}},eventScrollArticleEnd:function(a){var b=this,d=a.data("id"),c=a.data("text-length");0<$(".article__body",a).length&&$(window).bind("scroll.article_end_"+d,function(){var e=$(".article__body",a),e=e.offset().top+e.height()-b.getClientHeigth()+100;$(window).scrollTop()>e&&(window.EVENTSTACK.push(["scroll","article_end",{article_id:d,textlength:c}]),
$(window).unbind("scroll.article_end_"+d))})},updateSets:function(){this.$items=$(this["class"].endlessItem+":not(."+this["class"].modFollow+")",this.$endless);this.$followItems=$(this["class"].endlessItem+"."+this["class"].modFollow,this.$endless);this.$activeItem=$(this.$items[this.$items.length-1]);this.$followItemsContent=$(this["class"].endlessItemContent,this.$followItems);this.$followItems.removeClass(this["class"].modActive);this.$items.removeClass(this["class"].modActive);this.$activeItem.addClass(this["class"].modActive)},
getClientHeigth:function(){return Math.max(window.innerHeight||0,(document.getElementsByTagName("html")[0]||{}).clientHeight||0)}};endlessScroll.init()});
$(function(){var a=!1;$("body").on("click",".js-article-like",function(a){a.preventDefault();var b=$(this);$.ajax({url:"/services/article/like/",data:{article_id:b.data("id")},dataType:"json"}).done(function(a){"success"===a.status&&b.find("span").text(a.likes)})});$("body").on("click",".article__userbar-emoji .emoji-item",function(b){b.preventDefault();var c=$(this);a||$.ajax({url:"/services/article/add_emoji/",data:{article_id:GLOBAL.article.id,emotion:c.data("type")},dataType:"json",beforeSend:function(){a=
!0}}).done(function(a){if("success"===a.status){var b=c.closest(".emoji").find(".emoji-item");b.filter(".m-type-s1").find(".m-value").text(a.s1);b.filter(".m-type-s2").find(".m-value").text(a.s2);b.filter(".m-type-s3").find(".m-value").text(a.s3);b.filter(".m-type-s4").find(".m-value").text(a.s4);b.filter(".m-type-s5").find(".m-value").text(a.s5);b.filter(".m-type-s6").find(".m-value").text(a.s6);b.each(function(){var a=$(this);"0"===a.find(".m-value").text()?a.removeClass("m-active"):a.addClass("m-active")})}}).always(function(){a=
!1})});$("body").on("click",".best-comments__item-like",function(a){a.stopPropagation();a=$(this);var b,c=768<$(document).width();b=a.closest(".best-comments__item");$(".best__popper-emoji").remove();b=b.find(".emoji-popper").clone(!0);b.addClass("best__popper-emoji");$("body").append(b);new Popper(a,b,{placement:c?"bottom":"left",modifiers:{preventOverflow:{enabled:!0,padding:0,boundariesElement:c?a.closest(".best-comments__item"):"window"}}});b.fadeToggle();$("body").one("click.best__popper-emoji",
function(){$(".best__popper-emoji").remove()})});$(".stattags__content-list").each(function(){$(this).theinCarousel({nav:!0,navText:['<i><svg class="svg-icon"><use xlink:href="#icon-left_single"/></svg></i>','<i><svg class="svg-icon"><use xlink:href="#icon-right_single"/></svg></i>'],itemWidth:239,between:10,stretch:!1,outside:0,responsive:{480:{outside:0}}})});$(".stattags").on("click",".stattags__tab",function(a){a.preventDefault();a=$(this);a.addClass("m-active").siblings(".stattags__tab").removeClass("m-active");
$(a.data("for")).addClass("m-active").siblings(".stattags__content").removeClass("m-active")});var b=!0,d=function(a){a=$(".endless__item.m-active").find('.article__aggr[data-visiblepush="no"]');if(a.length){var c=a.offset().top,d=c+a.outerHeight(),g=$(window).scrollTop(),h=g+$(window).height()-105;b=!0}d>g&&c<h&&b&&(b=!1,a.attr({"data-visiblepush":"yes"}),window.dataLayer=window.dataLayer||[],dataLayer.push({event:"dl_block_visibility",block_name:"\u0427\u0438\u0442\u0430\u0442\u044c \u0432 \u0440\u0438\u0430",
page_path:window.location.pathname}))};if($(".endless__item.m-active").find('.article__aggr[data-visiblepush="no"]').length)$(window).on("DOMContentLoaded load resize scroll",d);$(".article__aggr-item").on("click",function(a){window.dataLayer=window.dataLayer||[];dataLayer.push({event:"dl_block_click",block_name:"\u0427\u0438\u0442\u0430\u0442\u044c \u0432 \u0440\u0438\u0430",page_path:window.location.pathname})})});
